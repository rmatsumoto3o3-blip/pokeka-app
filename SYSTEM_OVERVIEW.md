# ポケカ対戦記録・デッキ管理システム (仮称: 松本さんの巣) システム仕様書

## 1. 概要
本システムは、ポケモンカードゲームのプレイヤーが「デッキの調整履歴」と「対戦成績」を効率的に管理し、勝率向上を目指すためのWebアプリケーションです。

## 2. コアコンセプト
- **バージョン管理**: デッキを単なる「リスト」ではなく、「調整の歴史（バージョン）」として管理します。
- **階層構造**: 似たデッキを「フォルダ（アーキタイプ）」でまとめ、微調整を「バリエーション」として紐付けます。
- **シームレスな移行**: 公式デッキ作成ツールとの連携を前提としつつ、アプリ内での独自のカスタム調整も可能です。

## 3. 主要機能

### 3.1 デッキ管理 (Deck Management)
ユーザーは以下の階層構造でデッキを管理します。

1.  **デッキフォルダ (Archetype)**
    *   **役割**: 「リザードンex」「ドラパルトex」などのデッキタイプごとのコンテナ。
    *   **機能**: フォルダ全体の勝率集計、バリエーションの整理。
2.  **デッキバリエーション (Variant)**
    *   **役割**: 実際に使用する個別のデッキリスト（例: v1.0, v1.1 ビーダル型）。
    *   **登録方法**:
        *   **公式デッキコード**: ポケモンカード公式チャンネルのデッキコードからインポート。
        *   **カスタムビルド**: アプリ内の「作業机」で編集した独自リスト（公式コード不要）。
    *   **機能**: バージョンごとの勝率記録、サイドボード（入れ替え候補カード）の管理。

### 3.2 対戦記録 (Match Recording)
- **記録項目**: 勝敗、対戦相手のデッキタイプ、先攻/後攻、メモ。
- **集計**:
    *   デッキごとの勝率
    *   フォルダ（アーキタイプ）ごとの勝率
    *   直近の戦績推移

### 3.3 一人回し・検証 (Solo Play / Practice)
- **作業机 (Work Table)**:
    *   データベースに保存せず、一時的にデッキコードを展開・検証できるサンドボックス領域。
    *   カードのドラッグ＆ドロップによる入れ替えが可能。
- **バトルシミュレータ**:
    *   ブラウザ上でカードを並べ、初動の確認や一人回しを行う簡易シミュレータ機能。
    *   対戦相手がいなくてもデッキの事故率などを確認可能。

### 3.4 ユーザー管理と利用制限 (Accounts & Limits)
Supabase認証を使用したログイン管理と、プランによる利用制限を設けています。

| プラン | 親枠上限 (フォルダ数) | 子枠上限 (1フォルダ内のデッキ数) | 備考 |
| :--- | :--- | :--- | :--- |
| **Free (一般)** | **3** | **5** | 未招待の初期ユーザー |
| **Invited (招待)** | **5** | **20** | 招待コード入力済みユーザー |
| **Admin** | 無制限 | 無制限 | 管理者 |

*※「親枠」には、フォルダだけでなく「未分類のデッキ（Loose Decks）」も1つにつき1枠としてカウントされます。*

## 4. 技術スタック
- **Frontend**: Next.js (App Router), React, Tailwind CSS
- **Backend**: Supabase (PostgreSQL, Auth, RLS)
- **Deploy**: Vercel (想定)

## 5. 今後の拡張予定 (Roadmap)
- スマホ版UIの最適化 (Mobile Polish)
- バトルシミュレータの盤面操作機能強化
- 対戦履歴のグラフ化・詳細分析
